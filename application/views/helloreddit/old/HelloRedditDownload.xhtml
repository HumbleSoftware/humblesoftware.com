<script type="text/javascript">
	Event.observe(window, 'dom:loaded', function (e) {
		// Observe downloadForm submit.
		Event.observe($('downloadForm'), 'submit', function (e) {
			
			f = this;
			
			vals = Form.serializeElements(Form.getElements(f));
			url = '<?php echo HumbleConfig::$WEB_ROOT; ?>download';
			
			Form.disable(f);
			
			new Ajax.Request(url, {
				'method': 'post',
				'parameters': vals,
				'onSuccess': function (t) {
					$('downloadFormMessage').update(t.responseText);
					Form.enable(f);
					Form.Element.clear($('downloadFormEmail'));
					
				},
				'onFailure': function (t) {
					alert("Ajax Failure");
					Form.enable(f);
				}
			});
			
			e.stop();
		})
	});
</script>
<div id="downloadFormMessage"></div>
<form id="downloadForm" action="<?php echo HumbleConfig::$WEB_ROOT; ?>download" method="post">
	<input type="hidden" name="action" value="getKey" />
	<div class="form">
		<div class="formItem">
			<div class="formLabel"><label for="formEmail">Email Address:</label></div>
			<div class="formInput"><input id="downloadFormEmail" type="text" name="email"></input></div>
			<div class="formDescription">The email address you used during your purchase.</div>
		</div>
		<div class="formItem">
			<div class="formInput formSubmit"><input type="submit" name="submit" value="Download Now" /></div>
		</div>
	</div>
</form>