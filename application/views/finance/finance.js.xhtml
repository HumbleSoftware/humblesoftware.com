<span class="com">////////////////////////////////////////////////////////////////////</span><span class="pln"><br /></span><span class="com">// Copyright (c) 2010 Humble Software Development</span><span class="pln"><br /></span><span class="com">//</span><span class="pln"><br /></span><span class="com">// Permission is hereby granted, free of charge, to any person</span><span class="pln"><br /></span><span class="com">// obtaining a copy of this software and associated documentation</span><span class="pln"><br /></span><span class="com">// files (the "Software"), to deal in the Software without</span><span class="pln"><br /></span><span class="com">// restriction, including without limitation the rights to use,</span><span class="pln"><br /></span><span class="com">// copy, modify, merge, publish, distribute, sublicense, and/or sell</span><span class="pln"><br /></span><span class="com">// copies of the Software, and to permit persons to whom the</span><span class="pln"><br /></span><span class="com">// Software is furnished to do so, subject to the following</span><span class="pln"><br /></span><span class="com">// conditions:</span><span class="pln"><br /></span><span class="com">//</span><span class="pln"><br /></span><span class="com">// The above copyright notice and this permission notice shall be</span><span class="pln"><br /></span><span class="com">// included in all copies or substantial portions of the Software.</span><span class="pln"><br /></span><span class="com">//</span><span class="pln"><br /></span><span class="com">// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,</span><span class="pln"><br /></span><span class="com">// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES</span><span class="pln"><br /></span><span class="com">// OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span><span class="pln"><br /></span><span class="com">// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT</span><span class="pln"><br /></span><span class="com">// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,</span><span class="pln"><br /></span><span class="com">// WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span><span class="pln"><br /></span><span class="com">// FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span><span class="pln"><br /></span><span class="com">// OTHER DEALINGS IN THE SOFTWARE.</span><span class="pln"><br /></span><span class="com">////////////////////////////////////////////////////////////////////</span><span class="pln"><br /><br /></span><span class="com">/**<br />&nbsp;* Humble Flinance Flotr Financial Charts<br />&nbsp;* <br />&nbsp;* @license MIT License &lt;http://www.opensource.org/licenses/mit-license.php&gt;<br />&nbsp;* @author Carl Sutherland<br />&nbsp;* @version 1.0 <br />&nbsp;*/</span><span class="pln"><br /></span><span class="kwd">var</span><span class="pln"> </span><span class="typ">HumbleFlinance</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br /><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* ID of element to attach chart<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member String<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; id</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Graphs used to display data <br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Object<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; graphs</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">price</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> volume</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> summary</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Div containers for graphs<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Object<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; containers</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">price</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> volume</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> summary</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Div handles for interaction with graphs<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Object<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; handles</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">left</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> right</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> scroll</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">},</span><span class="pln"> <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Bounds on data<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Object<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; bounds</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">xmin</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> xmax</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> ymin</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> ymax</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Array of data displayed in first graph.<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Array<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; priceData</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[],</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Array of data displayed in second graph<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Array<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; volumeData</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[],</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Array of data to serve as a visual summary of the above graphs<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member Array<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; summaryData</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[],</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Formatter for x axis ticks<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member function<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; xTickFormatter</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Flotr</span><span class="pun">.</span><span class="pln">defaultTickFormatter</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Formatter for y axis ticks<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member function<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; yTickFormatter</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Flotr</span><span class="pun">.</span><span class="pln">defaultTickFormatter</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Formatter for mouse tracking<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @member function<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; trackFormatter</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Flotr</span><span class="pun">.</span><span class="pln">defaultTrackFormatter</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Initialization function<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param String id<br />&nbsp; &nbsp; &nbsp;* @param Array priceData<br />&nbsp; &nbsp; &nbsp;* @param Array volumeData<br />&nbsp; &nbsp; &nbsp;* @param Array summaryData<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; init</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="pln"> priceData</span><span class="pun">,</span><span class="pln"> volumeData</span><span class="pun">,</span><span class="pln"> summaryData</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set members</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">id </span><span class="pun">=</span><span class="pln"> id</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData </span><span class="pun">=</span><span class="pln"> priceData</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeData </span><span class="pun">=</span><span class="pln"> volumeData</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">summaryData </span><span class="pun">=</span><span class="pln"> summaryData</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set bounds to scale automatically in the y direction</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">.</span><span class="pln">xmin </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">.</span><span class="pln">xmax </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">.</span><span class="pln">ymin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">.</span><span class="pln">ymax </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set up DOM</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">buildDOM</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">attachEventObservers</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Initialize graphs, setting selection on summary</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y1</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">.</span><span class="pln">ymin</span><span class="pun">,</span><span class="pln"> <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2</span><span class="pun">:</span><span class="pln"> </span><span class="lit">100</span><span class="pun">,</span><span class="pln"> <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y2</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">.</span><span class="pln">ymax<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">summaryGraph</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">summaryData</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">setSelection</span><span class="pun">(</span><span class="pln">area</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Build DOM elements and insert into container.<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; buildDOM</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> container </span><span class="pun">=</span><span class="pln"> $</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">id</span><span class="pun">);</span><span class="pln"><br /></span><span class="com">// &nbsp; &nbsp; &nbsp; &nbsp;container.onselectstart = function () {return false;};</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Build DOM element</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Element</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="str">'priceGraph'</span><span class="pun">,</span><span class="pln"> style</span><span class="pun">:</span><span class="pln"> </span><span class="str">'width: 800px; height: 240px;'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Element</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="str">'volumeGraph'</span><span class="pun">,</span><span class="pln"> style</span><span class="pun">:</span><span class="pln"> </span><span class="str">'width: 800px; height: 80px;'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Element</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="str">'summaryGraph'</span><span class="pun">,</span><span class="pln"> style</span><span class="pun">:</span><span class="pln"> </span><span class="str">'width: 800px; height: 60px;'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Element</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="str">'leftHandle'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'class'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'handle zoomHandle'</span><span class="pun">,</span><span class="pln"> style</span><span class="pun">:</span><span class="pln"> </span><span class="str">'display: none;'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Element</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="str">'rightHandle'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'class'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'handle zoomHandle'</span><span class="pun">,</span><span class="pln"> style</span><span class="pun">:</span><span class="pln"> </span><span class="str">'display: none;'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Element</span><span class="pun">(</span><span class="str">'div'</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">id</span><span class="pun">:</span><span class="pln"> </span><span class="str">'scrollHandle'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'class'</span><span class="pun">:</span><span class="pln"> </span><span class="str">'handle scrollHandle'</span><span class="pun">,</span><span class="pln"> style</span><span class="pun">:</span><span class="pln"> </span><span class="str">'display: none;'</span><span class="pun">});</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">onselectstart </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"> </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">.</span><span class="pln">onselectstart </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"> </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">onselectstart </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"> </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Insert into container</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; container</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; container</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; container</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; container</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; container</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; container</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Attach event observers<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; attachEventObservers</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Attach summary click event to clear selection</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:click'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">reset</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Attach observers for hit tracking on price and volume points</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:hit'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeHitObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:clearhit'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">clearHit</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:hit'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceHitObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:clearhit'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">clearHit</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Handle observers</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:select'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">positionScrollHandle</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:select'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">positionZoomHandles</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousedown'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">zoomObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousedown'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">zoomObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousedown'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">scrollObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// On manual selection, hide zoom and scroll handles</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousedown'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">hideSelection</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Attach summary selection event to redraw price and volume charts</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:select'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">selectObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Summary Graph Selection Observer<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; selectObserver</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; xmin </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">floor</span><span class="pun">(</span><span class="pln">area</span><span class="pun">.</span><span class="pln">x1</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; xmax </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">ceil</span><span class="pun">(</span><span class="pln">area</span><span class="pun">.</span><span class="pln">x2</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> newBounds </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'xmin'</span><span class="pun">:</span><span class="pln"> xmin</span><span class="pun">,</span><span class="pln"> </span><span class="str">'xmax'</span><span class="pun">:</span><span class="pln"> xmax</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ymin'</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="str">'ymax'</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">price </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceGraph</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">(</span><span class="pln">xmin</span><span class="pun">,</span><span class="pln"> xmax</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> newBounds</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">volume </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeGraph</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeData</span><span class="pun">.</span><span class="pln">slice</span><span class="pun">(</span><span class="pln">xmin</span><span class="pun">,</span><span class="pln"> xmax</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> newBounds</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Reset to null selection<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; reset</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">price </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceGraph</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">volume </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeGraph</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeData</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">bounds</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Hide selection and handles<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; hideSelection</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Hide handles</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Clear selection</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">clearSelection</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Set the position of the scroll handle<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; positionScrollHandle</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x1 </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">x1</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x2 </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">x2</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xaxis </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> plotOffset </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">plotOffset</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> graphOffset </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">positionedOffset</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> graphHeight </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">getHeight</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> height </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">getHeight</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set width</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> width </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">floor</span><span class="pun">(</span><span class="pln">xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">))</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; width </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">width </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">10</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">18</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> width</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set positions</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xPosLeft </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">floor</span><span class="pun">(</span><span class="pln">graphOffset</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> plotOffset</span><span class="pun">.</span><span class="pln">left </span><span class="pun">+</span><span class="pln"> xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> width</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> yPos </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">ceil</span><span class="pun">(</span><span class="pln">graphOffset</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> graphHeight </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">setStyle</span><span class="pun">({</span><span class="pln">position</span><span class="pun">:</span><span class="pln"> </span><span class="str">'absolute'</span><span class="pun">,</span><span class="pln"> left</span><span class="pun">:</span><span class="pln"> xPosLeft</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">,</span><span class="pln"> top</span><span class="pun">:</span><span class="pln"> yPos</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">,</span><span class="pln"> width</span><span class="pun">:</span><span class="pln"> width</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">show</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Begin scrolling observer<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; scrollObserver</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientX</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">scroll</span><span class="pun">.</span><span class="pln">cumulativeOffset</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> prevSelection </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">prevSelection</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* Perform scroll on handle move, observer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> handleObserver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> deltaX </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientX </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xAxis </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x1 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> deltaX</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x2 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> deltaX</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Check and handle boundary conditions</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x1 </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x2 </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x2 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">length</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">length </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x2 </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set selection area object</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1</span><span class="pun">:</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y1</span><span class="pun">:</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2</span><span class="pun">:</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y2</span><span class="pun">:</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">y<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// If selection varies from previous, set new selection</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">area</span><span class="pun">.</span><span class="pln">x1 </span><span class="pun">!=</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">setSelection</span><span class="pun">(</span><span class="pln">area</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* End scroll observer to detach event listeners<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">function</span><span class="pln"> handleEndObserver </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mouseup'</span><span class="pun">,</span><span class="pln"> handleEndObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Attach scroll handle observers</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mouseup'</span><span class="pun">,</span><span class="pln"> handleEndObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Begin zooming observer<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; zoomObserver</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> zoomHandle </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">element</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientX</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> zoomHandle</span><span class="pun">.</span><span class="pln">cumulativeOffset</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> prevSelection </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">prevSelection</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* Perform zoom on handle move, observer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> handleObserver </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> deltaX </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">clientX </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xAxis </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set initial new x bounds</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> x2</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Element</span><span class="pun">.</span><span class="pln">identify</span><span class="pun">(</span><span class="pln">zoomHandle</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'rightHandle'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">x</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> deltaX</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Element</span><span class="pun">.</span><span class="pln">identify</span><span class="pun">(</span><span class="pln">zoomHandle</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'leftHandle'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> deltaX</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">x</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Check and handle boundary conditions</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x1 </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x2 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">length</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set selection area object</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1</span><span class="pun">:</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y1</span><span class="pun">:</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2</span><span class="pun">:</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"> <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y2</span><span class="pun">:</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">y<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// If selection varies from previous, set new selection</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">area</span><span class="pun">.</span><span class="pln">x1 </span><span class="pun">!=</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x </span><span class="pun">||</span><span class="pln"> area</span><span class="pun">.</span><span class="pln">x2 </span><span class="pun">!=</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">setSelection</span><span class="pun">(</span><span class="pln">area</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* End zoom observer to detach event listeners<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">function</span><span class="pln"> handleEndObserver </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mouseup'</span><span class="pun">,</span><span class="pln"> handleEndObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Attach handler slide event listeners</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mousemove'</span><span class="pun">,</span><span class="pln"> handleObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="pln">document</span><span class="pun">,</span><span class="pln"> </span><span class="str">'mouseup'</span><span class="pun">,</span><span class="pln"> handleEndObserver</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Perform a manual zoom.<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* Zoom backwards from the right zoom handle. &nbsp;If no selection or handles<br />&nbsp; &nbsp; &nbsp;* are present, zoom backwards from the right hand side.<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param integer x<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; zoom</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> prevSelection </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">prevSelection</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xAxis </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x2 </span><span class="pun">=</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> area </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x1</span><span class="pun">:</span><span class="pln"> xAxis</span><span class="pun">.</span><span class="pln">p2d</span><span class="pun">(</span><span class="pln">prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">x</span><span class="pun">),</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y1</span><span class="pun">:</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x2</span><span class="pun">:</span><span class="pln"> x2</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y2</span><span class="pun">:</span><span class="pln"> prevSelection</span><span class="pun">.</span><span class="pln">second</span><span class="pun">.</span><span class="pln">y<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">};</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">setSelection</span><span class="pun">(</span><span class="pln">area</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Set the position of the zoom handles<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; positionZoomHandles</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x1 </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">x1</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> x2 </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">x2</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xaxis </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> plotOffset </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">plotOffset</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> height </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">getHeight</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">summary</span><span class="pun">.</span><span class="pln">positionedOffset</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">show</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> dimensions </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">getDimensions</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Set positions</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xPosOne </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">floor</span><span class="pun">(</span><span class="pln">offset</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]+</span><span class="pln">plotOffset</span><span class="pun">.</span><span class="pln">left</span><span class="pun">+</span><span class="pln">xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x1</span><span class="pun">)-</span><span class="pln">dimensions</span><span class="pun">.</span><span class="pln">width</span><span class="pun">/</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xPosTwo </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">ceil</span><span class="pun">(</span><span class="pln">offset</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]+</span><span class="pln">plotOffset</span><span class="pun">.</span><span class="pln">left</span><span class="pun">+</span><span class="pln">xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">x2</span><span class="pun">)-</span><span class="pln">dimensions</span><span class="pun">.</span><span class="pln">width</span><span class="pun">/</span><span class="lit">2</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xPosLeft </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">xPosOne</span><span class="pun">,</span><span class="pln"> xPosTwo</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xPosRight </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">xPosOne</span><span class="pun">,</span><span class="pln"> xPosTwo</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> yPos </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">floor</span><span class="pun">(</span><span class="pln">offset</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">height</span><span class="pun">/</span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> dimensions</span><span class="pun">.</span><span class="pln">height</span><span class="pun">/</span><span class="lit">2</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">setStyle</span><span class="pun">({</span><span class="pln">position</span><span class="pun">:</span><span class="pln"> </span><span class="str">'absolute'</span><span class="pun">,</span><span class="pln"> left</span><span class="pun">:</span><span class="pln"> xPosLeft</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">,</span><span class="pln"> top</span><span class="pun">:</span><span class="pln"> yPos</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">.</span><span class="pln">setStyle</span><span class="pun">({</span><span class="pln">position</span><span class="pun">:</span><span class="pln"> </span><span class="str">'absolute'</span><span class="pun">,</span><span class="pln"> left</span><span class="pun">:</span><span class="pln"> xPosRight</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">,</span><span class="pln"> top</span><span class="pun">:</span><span class="pln"> yPos</span><span class="pun">+</span><span class="str">'px'</span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">left</span><span class="pun">.</span><span class="pln">show</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">handles</span><span class="pun">.</span><span class="pln">right</span><span class="pun">.</span><span class="pln">show</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br /><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Clear point hits for price and volume graphs.<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; clearHit</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">price</span><span class="pun">.</span><span class="pln">clearHit</span><span class="pun">();</span><span class="com">//.mouseTrack.hide();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">.</span><span class="pln">clearHit</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Observer for volume hit to set price hit<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; volumeHitObserver</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Hide mouse track on volume graph</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">.</span><span class="pln">mouseTrack</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Display hit on price graph</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> point </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceData</span><span class="pun">[</span><span class="pln">e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">x</span><span class="pun">];</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:hit'</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">doHit</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln"> point</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:hit'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeHitObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Observer for price hit to set volume hit<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param e MouseEvent<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; priceHitObserver</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Display hit on volume graph</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> point </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">volumeData</span><span class="pun">[</span><span class="pln">e</span><span class="pun">.</span><span class="pln">memo</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">x</span><span class="pun">];</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">stopObserving</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:hit'</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">doHit</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">,</span><span class="pln"> point</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Event</span><span class="pun">.</span><span class="pln">observe</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">containers</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln"> </span><span class="str">'flotr:hit'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">priceHitObserver</span><span class="pun">.</span><span class="pln">bind</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">));</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Hide mouse track on volume graph</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">graphs</span><span class="pun">.</span><span class="pln">volume</span><span class="pun">.</span><span class="pln">mouseTrack</span><span class="pun">.</span><span class="pln">hide</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Calculate hit location from one graph and perform hit on another<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param Flotr.Graph graph &nbsp;Destination graph.<br />&nbsp; &nbsp; &nbsp;* @param Array point &nbsp;The coordinates of the hit as [x, y].<br />&nbsp; &nbsp; &nbsp;* @param Element container &nbsp;The container of the source graph.<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; doHit</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">graph</span><span class="pun">,</span><span class="pln"> point</span><span class="pun">,</span><span class="pln"> container</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> container</span><span class="pun">.</span><span class="pln">cumulativeOffset</span><span class="pun">();</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xaxis </span><span class="pun">=</span><span class="pln"> graph</span><span class="pun">.</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">x</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> yaxis </span><span class="pun">=</span><span class="pln"> graph</span><span class="pun">.</span><span class="pln">axes</span><span class="pun">.</span><span class="pln">y</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> relX </span><span class="pun">=</span><span class="pln"> xaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">point</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> relY </span><span class="pun">=</span><span class="pln"> yaxis</span><span class="pun">.</span><span class="pln">d2p</span><span class="pun">(</span><span class="pln">point</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> absX </span><span class="pun">=</span><span class="pln"> offset</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]+</span><span class="pln">relX</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> absY </span><span class="pun">=</span><span class="pln"> offset</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">relY</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> mouse </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">'relX'</span><span class="pun">:</span><span class="pln"> relX</span><span class="pun">,</span><span class="pln"> </span><span class="str">'relY'</span><span class="pun">:</span><span class="pln"> relY</span><span class="pun">,</span><span class="pln"> </span><span class="str">'absX'</span><span class="pun">:</span><span class="pln"> absX</span><span class="pun">,</span><span class="pln"> </span><span class="str">'absY'</span><span class="pun">:</span><span class="pln"> absY</span><span class="pun">};</span><span class="pln"> <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; graph</span><span class="pun">.</span><span class="pln">hit</span><span class="pun">(</span><span class="pln">mouse</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Draw the price graph<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param Array data<br />&nbsp; &nbsp; &nbsp;* @param Array bounds<br />&nbsp; &nbsp; &nbsp;* @return Flotr.Graph<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; priceGraph</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> bounds</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xmin </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">xmin</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xmax </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">xmax</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> ymin </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">ymin</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> ymax </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">ymax</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Flotr</span><span class="pun">.</span><span class="pln">draw</span><span class="pun">(</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'priceGraph'</span><span class="pun">),</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[</span><span class="pln">data</span><span class="pun">],</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lines</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">show</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> fill</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> fillOpacity</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> lineWidth</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; yaxis</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> ymin</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">:</span><span class="pln"> ymax</span><span class="pun">,</span><span class="pln"> tickFormatter</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">yTickFormatter</span><span class="pun">,</span><span class="pln"> noTicks</span><span class="pun">:</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> autoscaleMargin</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> &nbsp;tickDecimals</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xaxis</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> xmin</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">:</span><span class="pln"> xmax</span><span class="pun">,</span><span class="pln"> showLabels</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; grid</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">outlineWidth</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> labelMargin</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouse</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">track</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> sensibility</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> trackDecimals</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> trackFormatter</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">trackFormatter</span><span class="pun">,</span><span class="pln"> position</span><span class="pun">:</span><span class="pln"> </span><span class="str">'ne'</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shadowSize</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">HtmlText</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> p</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br /><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Draw the volume graph<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param Array data<br />&nbsp; &nbsp; &nbsp;* @param Array bounds<br />&nbsp; &nbsp; &nbsp;* @return Flotr.Graph<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; volumeGraph</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> bounds</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xmin </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">xmin</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xmax </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">xmax</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> ymin </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">ymin</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> ymax </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">ymax</span><span class="pun">;</span><span class="pln"><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Flotr</span><span class="pun">.</span><span class="pln">draw</span><span class="pun">(</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'volumeGraph'</span><span class="pun">),</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[</span><span class="pln">data</span><span class="pun">],</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bars</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">show</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">'barWidth'</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="str">'fill'</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">'lineWidth'</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="str">'fillOpacity'</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; yaxis</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> ymin</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">:</span><span class="pln"> ymax</span><span class="pun">,</span><span class="pln"> autoscaleMargin</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> showLabels</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> tickDecimals</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xaxis</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> xmin</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">:</span><span class="pln"> xmax</span><span class="pun">,</span><span class="pln"> showLabels</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> labelsAngle</span><span class="pun">:</span><span class="pln"> </span><span class="lit">60</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; grid</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">verticalLines</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> horizontalLines</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> outlineWidth</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> labelMargin</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mouse</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">track</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> sensibility</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> position</span><span class="pun">:</span><span class="pln"> </span><span class="str">'ne'</span><span class="pun">,</span><span class="pln"> trackDecimals</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shadowSize</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">HtmlText</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> v</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">},</span><span class="pln"><br /><br />&nbsp; &nbsp; </span><span class="com">/**<br />&nbsp; &nbsp; &nbsp;* Draw the summary graph<br />&nbsp; &nbsp; &nbsp;* <br />&nbsp; &nbsp; &nbsp;* @param Array data<br />&nbsp; &nbsp; &nbsp;* @param Array bounds<br />&nbsp; &nbsp; &nbsp;* @return Flotr.Graph<br />&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br />&nbsp; &nbsp; summaryGraph</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> bounds</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xmin </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">xmin</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> xmax </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">xmax</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> ymin </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">ymin</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> ymax </span><span class="pun">=</span><span class="pln"> bounds</span><span class="pun">.</span><span class="pln">ymax</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Flotr</span><span class="pun">.</span><span class="pln">draw</span><span class="pun">(</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $</span><span class="pun">(</span><span class="str">'summaryGraph'</span><span class="pun">),</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">[</span><span class="pln">data</span><span class="pun">],</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lines</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">show</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> fill</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> fillOpacity</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> lineWidth</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; yaxis</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> ymin</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">:</span><span class="pln"> ymax</span><span class="pun">,</span><span class="pln"> autoscaleMargin</span><span class="pun">:</span><span class="pln"> </span><span class="pun">.</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> showLabels</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> tickDecimals</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xaxis</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> xmin</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">:</span><span class="pln"> xmax</span><span class="pun">,</span><span class="pln"> noTicks</span><span class="pun">:</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> tickFormatter</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">xTickFormatter</span><span class="pun">,</span><span class="pln"> labelsAngle</span><span class="pun">:</span><span class="pln"> </span><span class="lit">60</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; grid</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">verticalLines</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> horizontalLines</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"> labelMargin</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> outlineWidth</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; selection</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">mode</span><span class="pun">:</span><span class="pln"> </span><span class="str">'x'</span><span class="pun">},</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shadowSize</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">HtmlText</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> p</span><span class="pun">;</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span>